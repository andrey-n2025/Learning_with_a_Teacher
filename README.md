# Учебный проект "In One Click" по теме "Обучение с учителем"

### Краткое описание проекта "In One Click"

Интернет-магазин «В один клик» продаёт товары для детей, дома, мелкую бытовую технику, косметику и продукты. В последнее время наблюдается снижение активности покупателей. Вместо привлечения новых клиентов компания решила удерживать постоянных с помощью персонализированных предложений. Задача проекта — разработать модель машинного обучения для предсказания снижения покупательской активности и сегментировать клиентов для повышения их вовлечённости на основе анализа данных.


#### Цели проекта
 
- Построить модель, предсказывающую вероятность снижения покупательской активности в следующие три месяца.  
- Проанализировать данные о коммуникациях, продуктовом и покупательском поведении, а также поведении на сайте.  
- Выделить сегменты клиентов на основе модели и данных о прибыльности, предложить стратегии повышения активности.  
- Оценить важность признаков и дать рекомендации для бизнеса.

#### Данные

Использовались четыре таблицы:
1. **market_file.csv** — данные о поведении на сайте, коммуникациях и продуктовом поведении.
2. **market_money.csv** — данные о выручке по клиентам и периодам.
3. **market_time.csv** — данные о времени, проведённом на сайте.
4. **money.csv** — данные о средней месячной прибыли с клиента за последние три месяца.


#### Предобработка данных

- Проверка и исправление ошибок в данных.
- Устранение дубликатов.
- Переименование столбцов в соответствии с PEP8.
- Объединение таблиц и создание новых признаков.

#### Модели машинного обучения и результаты

Для предсказания снижения покупательской активности использовались и сравнивались следующие модели:

1. **Метод опорных векторов (SVC)**
2. **Логистическая регрессия**
3. **Метод k-ближайших соседей (KNN)**
4. **Дерево решений (DecisionTreeClassifier)**

**Метрика и подход:**
- Основная метрика — **F1-score** (баланс между precision и recall).
- Использованы пайплайны для предобработки данных.
- Гиперпараметры подбирались с помощью **GridSearchCV**.
- Стратифицированная кросс-валидация для надёжности оценок.


#### Анализ важности признаков

С помощью **SHAP анализа** выявлены наиболее влиятельные признаки:
 - `mean_pages_viewed_visit` -  'Страниц_за_визит'
 - `min_on_site_last_month` 'минут на сайте в прошлом месяце'
 - `mean_categories_viewed_visit` - 'Средний_просмотр_категорий_за_визит'
 - `min_on_site_cur_month` 'минут на сайте в текущем месяце'

Данные признаки описывают поведенческую активность клиента
 
#### Сегментация клиентов

На основе предсказаний лучшей модели (SVC) клиенты были разделены на 4 сегмента:

- Высокий риск, высокая прибыль     
- Высокий риск, низкая прибыль        
- Низкий риск риск, высокая прибыль    
- Низкий риск, низкая прибыль        

Для каждого сегмента клиентов были даны бизнес-рекомендации
 
#### Итог

Проект успешно демонстрирует использование машинного обучения для прогнозирования покупательского поведения.